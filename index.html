<!doctype html>
<html lang="in">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Crypto Mania</title>
    <link rel="stylesheet" href="css/index.css">
  </head>
  <body>
    <header>
      <nav>
        <a class="logo" href="">CryptoMania club</a>
      </nav>
    </header>
    <div class="main-login">
      <div class="left-login">
        <h2>faça o login<br>entre para o clube</h2>
        <img src="imagens/novo.svg" class="left-login-img" alt="hello">
      </div>
      <div class="rigth-login">
        <div class="card-login">
          
          <h1>LOGIN</h1>
          
          <div id="msgError"></div>
          
          <div class="textfield">
            <label id="labeluser" for="usuario">Usuario</label>
            <input type="text" name="usuario" placeholder="Usuario" id="login">
          </div>
          <div class="textfield">
            <label id="labelpass" for="senha">Senha</label>
            <input type="password" name="senha" placeholder="Senha" id="senha">
          </div>
          <button type="submit" onclick='logar()' class="btn-login">login</button>
          <p class="conta">Não tem conta ?
          <a class="cadastro" href="cadastro.html">Cadastre-se</a>
          </p>
        </div>
      </div>
    </div>
    <main></main>
      <script>
        function logar(){
          let login = document.querySelector('#login');
          let labeluser = document.querySelector('#labeluser');
          
          let senha = document.querySelector('#senha');
          let labelpass = document.querySelector('#labelpass');
          
          let msgError = document.querySelector('#msgError');
          let listaUser = [];
          let userValid = {
            nome: '',
            user: '',
            senha: ''
          }
          listaUser = JSON.parse(localStorage.getItem('listaUser'))
          listaUser.forEach((item) => {
            if(login.value == item.userCad && senha.value == item.senhaCad) {
              userValid = {
                nome: item.nomeCad,
                user: item.userCad,
                senha: item.senhaCad
              }
            }
          })
          if(login.value == false && senha.value == false) {
            alert('Cadastre-se!!')
            window.location.href = 'cadastro.html'
          }
          if(login.value == userValid.user && senha.value == userValid.senha) {
            window.location.href = 'logado.html'
            let token = Math.random().toString(16).substr(2) + Math.random().toString(16).substr(2)
            localStorage.setItem('token', token)
            localStorage.setItem('userLogado', JSON.stringify(userValid))
          } else {
            labeluser.setAttribute('style', 'color: red;')
            labelpass.setAttribute('style', 'color: red;')
            msgError.setAttribute('style', 'display: block;')
            msgError.innerHTML = 'Usuário ou senha incorretos!'
            login.focus()
          }
        }
      </script>
      
  </body>
</html> 
